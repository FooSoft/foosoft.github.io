<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=/lib/bootstrap/css/bootstrap.min.css><link rel=stylesheet href=/lib/tether/css/tether.min.css><link rel=stylesheet href=/lib/tether/css/tether-theme-basic.min.css><link rel=stylesheet href=/lib/lightbox/ekko-lightbox.css><link rel=stylesheet href=/main.css><title>FooSoft Productions - AnkiConnect</title><nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top"><a class=navbar-brand href=/><img src=/img/foosoft.png alt=FooSoft class=d-inline-block id=brand>
FooSoft Productions</a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarNavAltMarkup>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNavAltMarkup><div class="navbar-nav ml-auto"><a class="nav-item nav-link" href=/>Overview</a>
<a class="nav-item nav-link" href=/posts/>Posts</a>
<a class="nav-item nav-link" href=/portfolio/>Portfolio</a>
<a class="nav-item nav-link active" href=/projects/>Projects</a>
<a class="nav-item nav-link" href=/tags/>Tags</a></div></div></nav><div><a href=https://github.com/FooSoft/anki-connect class=github-corner><svg width="80" height="80" viewBox="0 0 250 250">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
            <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg></a></div><div class=container><h1>AnkiConnect</h1><div><a class="badge badge-secondary" href=/tags/anki/index.html>anki</a>
<a class="badge badge-secondary" href=/tags/anki-connect/index.html>anki-connect</a>
<a class="badge badge-secondary" href=/tags/gpl-license/index.html>gpl license</a>
<a class="badge badge-secondary" href=/tags/japanese/index.html>japanese</a>
<a class="badge badge-secondary" href=/tags/python/index.html>python</a>
<a class="badge badge-secondary" href=/tags/yomichan/index.html>yomichan</a></div><hr><p>AnkiConnect enables external applications such as <a href=https://foosoft.net/projects/yomichan/>Yomichan</a> to communicate with
<a href=https://apps.ankiweb.net/>Anki</a> over a simple HTTP API. Its capabilities include executing queries against the userâ€™s
card deck, automatically creating new cards, and more. AnkiConnect is compatible with the latest stable (2.1.x) releases
of Anki; older versions (2.0.x and below) are no longer supported.<h2 id=installation>Installation</h2><p>The installation process is similar to other Anki plugins and can be accomplished in three steps:<ol><li>Open the <code>Install Add-on</code> dialog by selecting <code>Tools</code> | <code>Add-ons</code> | <code>Browse & Install</code> in Anki.<li>Input <a href=https://ankiweb.net/shared/info/2055492159>2055492159</a> into the text box labeled <code>Code</code> and press the <code>OK</code> button to proceed.<li>Restart Anki when prompted to do so in order to complete the installation of AnkiConnect.</ol><p>Anki must be kept running in the background in order for other applications to be able to use AnkiConnect. You can
verify that AnkiConnect is running at any time by accessing <code>localhost:8765</code> in your browser. If the server is running,
you will see the message <code>AnkiConnect</code> displayed in your browser window.<h3 id=notes-for-windows-users>Notes for Windows Users</h3><p>Windows users may see a firewall nag dialog box appear on Anki startup. This occurs because AnkiConnect runs a local
HTTP server in order to enable other applications to connect to it. The host application, Anki, must be unblocked for
this plugin to function correctly.<h3 id=notes-for-mac-os-x-users>Notes for Mac OS X Users</h3><p>Starting with <a href=https://en.wikipedia.org/wiki/OS_X_Mavericks>Mac OS X Mavericks</a>, a feature named <em>App Nap</em> has been
introduced to the operating system. This feature causes certain applications which are open (but not visible) to be
placed in a suspended state. As this behavior causes AnkiConnect to stop working while you have another window in the
foreground, App Nap should be disabled for Anki:<ol><li>Start the Terminal application.<li>Execute the following commands in the terminal window:<ul><li><code>defaults write net.ankiweb.dtop NSAppSleepDisabled -bool true</code><li><code>defaults write net.ichi2.anki NSAppSleepDisabled -bool true</code><li><code>defaults write org.qt-project.Qt.QtWebEngineCore NSAppSleepDisabled -bool true</code></ul><li>Restart Anki.</ol><h2 id=application-interface-for-developers>Application Interface for Developers</h2><p>AnkiConnect exposes internal Anki features to external applications via an easy to use API. After being installed, this
plugin will start an HTTP sever on port 8765 whenever Anki is launched. Other applications (including browser
extensions) can then communicate with it via HTTP requests.<p>By default, AnkiConnect will only bind the HTTP server to the <code>127.0.0.1</code> IP address, so that you will only be able to
access it from the same host on which it is running. If you need to access it over a network, you can set the
environment variable <code>ANKICONNECT_BIND_ADDRESS</code> to change the binding address. For example, you can set it to <code>0.0.0.0</code>
in order to bind it to all network interfaces on your host.<h3 id=sample-invocation>Sample Invocation</h3><p>Every request consists of a JSON-encoded object containing an <code>action</code>, a <code>version</code>, contextual <code>params</code>, and a <code>key</code>
value used for authentication (which is optional and can be omitted by default). AnkiConnect will respond with an object
containing two fields: <code>result</code> and <code>error</code>. The <code>result</code> field contains the return value of the executed API, and the
<code>error</code> field is a description of any exception thrown during API execution (the value <code>null</code> is used if execution
completed successfully).<p><em>Sample successful response</em>:<pre><code class=language-json style=background-color:#fff>{<span style=color:#000080>&#34;result&#34;</span>: [<span style=color:#d14>&#34;Default&#34;</span>, <span style=color:#d14>&#34;Filtered Deck 1&#34;</span>], <span style=color:#000080>&#34;error&#34;</span>: <span style=color:#000;font-weight:bold>null</span>}
</code></pre><p><em>Samples of failed responses</em>:<pre><code class=language-json style=background-color:#fff>{<span style=color:#000080>&#34;result&#34;</span>: <span style=color:#000;font-weight:bold>null</span>, <span style=color:#000080>&#34;error&#34;</span>: <span style=color:#d14>&#34;unsupported action&#34;</span>}
</code></pre><pre><code class=language-json style=background-color:#fff>{<span style=color:#000080>&#34;result&#34;</span>: <span style=color:#000;font-weight:bold>null</span>, <span style=color:#000080>&#34;error&#34;</span>: <span style=color:#d14>&#34;guiBrowse() got an unexpected keyword argument &#39;foobar&#39;&#34;</span>}
</code></pre><p>For compatibility with clients designed to work with older versions of AnkiConnect, failing to provide a <code>version</code> field
in the request will make the version default to 4. Furthermore, when the provided version is level 4 or below, the API
response will only contain the value of the <code>result</code>; no <code>error</code> field is available for error handling.<p>You can use whatever language or tool you like to issue request to AnkiConnect, but a couple of simple examples are
included below as reference.<h4 id=curl>Curl</h4><pre><code class=language-bash style=background-color:#fff>curl localhost:8765 -X POST -d <span style=color:#d14>&#34;{\&#34;action\&#34;: \&#34;deckNames\&#34;, \&#34;version\&#34;: 6}&#34;</span>
</code></pre><h4 id=python>Python</h4><pre><code class=language-python style=background-color:#fff><span style=color:#000;font-weight:bold>import</span> <span style=color:#555>json</span>
<span style=color:#000;font-weight:bold>import</span> <span style=color:#555>urllib.request</span>

<span style=color:#000;font-weight:bold>def</span> <span style=color:#900;font-weight:bold>request</span>(action, <span style=color:#000;font-weight:bold>*</span><span style=color:#000;font-weight:bold>*</span>params):
    <span style=color:#000;font-weight:bold>return</span> {<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>action</span><span style=color:#d14>&#39;</span>: action, <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>params</span><span style=color:#d14>&#39;</span>: params, <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>version</span><span style=color:#d14>&#39;</span>: <span style=color:#099>6</span>}

<span style=color:#000;font-weight:bold>def</span> <span style=color:#900;font-weight:bold>invoke</span>(action, <span style=color:#000;font-weight:bold>*</span><span style=color:#000;font-weight:bold>*</span>params):
    requestJson <span style=color:#000;font-weight:bold>=</span> json<span style=color:#000;font-weight:bold>.</span>dumps(request(action, <span style=color:#000;font-weight:bold>*</span><span style=color:#000;font-weight:bold>*</span>params))<span style=color:#000;font-weight:bold>.</span>encode(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>utf-8</span><span style=color:#d14>&#39;</span>)
    response <span style=color:#000;font-weight:bold>=</span> json<span style=color:#000;font-weight:bold>.</span>load(urllib<span style=color:#000;font-weight:bold>.</span>request<span style=color:#000;font-weight:bold>.</span>urlopen(urllib<span style=color:#000;font-weight:bold>.</span>request<span style=color:#000;font-weight:bold>.</span>Request(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>http://localhost:8765</span><span style=color:#d14>&#39;</span>, requestJson)))
    <span style=color:#000;font-weight:bold>if</span> <span style=color:#0086b3>len</span>(response) <span style=color:#000;font-weight:bold>!=</span> <span style=color:#099>2</span>:
        <span style=color:#000;font-weight:bold>raise</span> <span style=color:#900;font-weight:bold>Exception</span>(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>response has an unexpected number of fields</span><span style=color:#d14>&#39;</span>)
    <span style=color:#000;font-weight:bold>if</span> <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>error</span><span style=color:#d14>&#39;</span> <span style=color:#000;font-weight:bold>not</span> <span style=color:#000;font-weight:bold>in</span> response:
        <span style=color:#000;font-weight:bold>raise</span> <span style=color:#900;font-weight:bold>Exception</span>(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>response is missing required error field</span><span style=color:#d14>&#39;</span>)
    <span style=color:#000;font-weight:bold>if</span> <span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>result</span><span style=color:#d14>&#39;</span> <span style=color:#000;font-weight:bold>not</span> <span style=color:#000;font-weight:bold>in</span> response:
        <span style=color:#000;font-weight:bold>raise</span> <span style=color:#900;font-weight:bold>Exception</span>(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>response is missing required result field</span><span style=color:#d14>&#39;</span>)
    <span style=color:#000;font-weight:bold>if</span> response[<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>error</span><span style=color:#d14>&#39;</span>] <span style=color:#000;font-weight:bold>is</span> <span style=color:#000;font-weight:bold>not</span> <span style=color:#999>None</span>:
        <span style=color:#000;font-weight:bold>raise</span> <span style=color:#900;font-weight:bold>Exception</span>(response[<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>error</span><span style=color:#d14>&#39;</span>])
    <span style=color:#000;font-weight:bold>return</span> response[<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>result</span><span style=color:#d14>&#39;</span>]

invoke(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>createDeck</span><span style=color:#d14>&#39;</span>, deck<span style=color:#000;font-weight:bold>=</span><span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>test1</span><span style=color:#d14>&#39;</span>)
result <span style=color:#000;font-weight:bold>=</span> invoke(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>deckNames</span><span style=color:#d14>&#39;</span>)
<span style=color:#000;font-weight:bold>print</span>(<span style=color:#d14></span><span style=color:#d14>&#39;</span><span style=color:#d14>got list of decks: {}</span><span style=color:#d14>&#39;</span><span style=color:#000;font-weight:bold>.</span>format(result))
</code></pre><h4 id=javascript>JavaScript</h4><pre><code class=language-javascript style=background-color:#fff><span style=color:#000;font-weight:bold>function</span> invoke(action, version, params<span style=color:#000;font-weight:bold>=</span>{}) {
    <span style=color:#000;font-weight:bold>return</span> <span style=color:#000;font-weight:bold>new</span> <span style=color:#0086b3>Promise</span>((resolve, reject) =&gt; {
        <span style=color:#000;font-weight:bold>const</span> xhr <span style=color:#000;font-weight:bold>=</span> <span style=color:#000;font-weight:bold>new</span> XMLHttpRequest();
        xhr.addEventListener(<span style=color:#d14>&#39;error&#39;</span>, () =&gt; reject(<span style=color:#d14>&#39;failed to issue request&#39;</span>));
        xhr.addEventListener(<span style=color:#d14>&#39;load&#39;</span>, () =&gt; {
            <span style=color:#000;font-weight:bold>try</span> {
                <span style=color:#000;font-weight:bold>const</span> response <span style=color:#000;font-weight:bold>=</span> JSON.parse(xhr.responseText);
                <span style=color:#000;font-weight:bold>if</span> (<span style=color:#0086b3>Object</span>.getOwnPropertyNames(response).length <span style=color:#000;font-weight:bold>!=</span> <span style=color:#099>2</span>) {
                    <span style=color:#000;font-weight:bold>throw</span> <span style=color:#d14>&#39;response has an unexpected number of fields&#39;</span>;
                }
                <span style=color:#000;font-weight:bold>if</span> (<span style=color:#000;font-weight:bold>!</span>response.hasOwnProperty(<span style=color:#d14>&#39;error&#39;</span>)) {
                    <span style=color:#000;font-weight:bold>throw</span> <span style=color:#d14>&#39;response is missing required error field&#39;</span>;
                }
                <span style=color:#000;font-weight:bold>if</span> (<span style=color:#000;font-weight:bold>!</span>response.hasOwnProperty(<span style=color:#d14>&#39;result&#39;</span>)) {
                    <span style=color:#000;font-weight:bold>throw</span> <span style=color:#d14>&#39;response is missing required result field&#39;</span>;
                }
                <span style=color:#000;font-weight:bold>if</span> (response.error) {
                    <span style=color:#000;font-weight:bold>throw</span> response.error;
                }
                resolve(response.result);
            } <span style=color:#000;font-weight:bold>catch</span> (e) {
                reject(e);
            }
        });

        xhr.open(<span style=color:#d14>&#39;POST&#39;</span>, <span style=color:#d14>&#39;http://127.0.0.1:8765&#39;</span>);
        xhr.send(JSON.stringify({action, version, params}));
    });
}

await invoke(<span style=color:#d14>&#39;createDeck&#39;</span>, {deck<span style=color:#000;font-weight:bold>:</span> <span style=color:#d14>&#39;test1&#39;</span>});
<span style=color:#000;font-weight:bold>const</span> result <span style=color:#000;font-weight:bold>=</span> await invoke(<span style=color:#d14>&#39;deckNames&#39;</span>, <span style=color:#099>6</span>);
console.log(<span style=color:#d14>`</span><span style=color:#d14>got list of decks: </span><span style=color:#d14>${</span>result<span style=color:#d14>}</span><span style=color:#d14>`</span>);
</code></pre><h3 id=supported-actions>Supported Actions</h3><p>Documentation for currently supported actions is split up by category and is referenced below. Note that deprecated APIs
will continue to function despite not being listed on this page as long as your request is labeled with a version number
corresponding to when the API was available for use.<ul><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/cards.md>Cards</a><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/decks.md>Decks</a><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/graphical.md>Graphical</a><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/media.md>Media</a><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/miscellaneous.md>Miscellaneous</a><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/models.md>Models</a><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/notes.md>Notes</a><li><a href=https://github.com/FooSoft/anki-connect/blob/master/actions/statistics.md>Statistics</a></ul><div><nav class=breadcrumb><a href=/projects/index.html class=breadcrumb-item>Projects</a>
<span class="breadcrumb-item active">AnkiConnect</span></nav></div></div><script src=/lib/jquery.min.js></script><script src=/lib/tether/js/tether.min.js></script><script src=/lib/bootstrap/js/bootstrap.min.js></script><script src=/lib/lightbox/ekko-lightbox.min.js></script><script src=/main.js></script><script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101024911);</script><script async src=//static.getclicky.com/js></script>