<!DOCTYPE html><html lang="en"><head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="/lib/tether/css/tether.min.css"/>
        <link rel="stylesheet" href="/lib/tether/css/tether-theme-basic.min.css"/>
        <link rel="stylesheet" href="/lib/lightbox/ekko-lightbox.css"/>
        <link rel="stylesheet" href="/main.css"/>
        
        <title>FooSoft Productions - Zero-EPWING</title>
        
    </head>
    <body>


<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <a class="navbar-brand" href="/">FooSoft Productions</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav ml-auto">
            
            <a class="nav-item nav-link " href="/">Overview</a>
            <a class="nav-item nav-link " href="/posts/">Posts</a>
            <a class="nav-item nav-link " href="/portfolio/">Portfolio</a>
            <a class="nav-item nav-link active" href="/projects/">Projects</a>
            <a class="nav-item nav-link " href="/tags/">Tags</a>
        </div>
    </div>
</nav>



<div>
    <a href="https://github.com/FooSoft/zero-epwing" class="github-corner">
        <svg width="80" height="80" viewBox="0 0 250 250">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
            <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
            <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
        </svg>
    </a>
</div>


<div class="container">
    <h1>
        Zero-EPWING
        
    </h1>
    

<div>
    
    <a class="badge badge-secondary" href="/tags/c/index.html">c</a>
    
    <a class="badge badge-secondary" href="/tags/epwing/index.html">epwing</a>
    
    <a class="badge badge-secondary" href="/tags/gpl-license/index.html">gpl license</a>
    
    <a class="badge badge-secondary" href="/tags/jansson/index.html">jansson</a>
    
    <a class="badge badge-secondary" href="/tags/japanese/index.html">japanese</a>
    
    <a class="badge badge-secondary" href="/tags/libeb/index.html">libeb</a>
    
    <a class="badge badge-secondary" href="/tags/zero-epwing/index.html">zero-epwing</a>
    
</div>


    <hr/>
    <p>Zero-EPWING is a tool built to export easy to process JSON formatted UTF-8 data from dictionaries in
<a href="https://ja.wikipedia.org/wiki/EPWING">EPWING</a> format. This is a terrible format for many reasons, some of which are
outlined below:</p>
<ul>
<li>It is based on a closed and undocumented standard.</li>
<li>Not well supported as it isn’t used anywhere else in the world.</li>
<li>The only library for parsing this format, <code>libeb</code>, is abandoned.</li>
<li>Data is stored in an inconsistent manner, with lots of duplication.</li>
<li>Text data is represented using the annoying EUC-JP encoding.</li>
<li>Characters which cannot be encoded are represented by image bitmaps.</li>
</ul>
<p>Most applications that parse EPWING data traditionally use <code>libeb</code> to perform dictionary searches in place; dealing with
quirks in the format and <code>libeb</code> output is just part of the process. Zero-EPWING takes a different approach – extract
all the data and output it an sane intermediate format, like JSON. As everyone knows how to parse JSON, it is trivial to
take this intermediate data and store it in a reasonable, industry standard representation.</p>
<p><img src="/projects/zero-epwing/img/zero-wing.png" alt=""/></p>
<h2 id="installation">Installation</h2>
<p>Pre-built binaries are available for Linux, Mac OS X, and Windows:</p>
<ul>
<li><a href="/projects/zero-epwing/dl/zero-epwing_linux.tar.gz">zero-epwing_linux.tar.gz</a></li>
<li><a href="/projects/zero-epwing/dl/zero-epwing_darwin.tar.gz">zero-epwing_darwin.tar.gz</a></li>
<li><a href="/projects/zero-epwing/dl/zero-epwing_windows.zip">zero-epwing_windows.zip</a></li>
</ul>
<h2 id="building">Building</h2>
<p>Prepare your development environment by making sure the following tools are set up:</p>
<ul>
<li><a href="https://www.gnu.org/software/automake/manual/html_node/Autotools-Introduction.html">Autotools</a></li>
<li><a href="https://cmake.org/">CMake</a></li>
<li><a href="https://gcc.gnu.org/">GCC</a></li>
<li><a href="https://www.gnu.org/software/make/">Make</a></li>
<li><a href="http://www.mingw.org/">MinGW</a> (Windows only)</li>
</ul>
<p>Once your system is configured, follow the steps below to create builds:</p>
<ol>
<li>Clone the repository by executing
<pre><code>git clone --recurse-submodules https://github.com/FooSoft/zero-epwing
</code></pre>
</li>
<li>Prepare the project. From the project root directory, execute
<pre><code>cmake . -Bbuild &amp;&amp; cmake --build build --
</code></pre>
</li>
<li>Find the executable in the <code>build</code> directory.</li>
</ol>
<h2 id="usage">Usage</h2>
<p>Zero-EPWING takes a single parameter, the directory of the EPWING dictionary to dump. It also supports the following
optional flags:</p>
<ul>
<li><code>--entries</code> (<code>-e</code>): output dictionary entry data (most common option).</li>
<li><code>--fonts</code> (<code>-f</code>): output output font bitmap data (useful for OCR).</li>
<li><code>--markup</code> (<code>-m</code>): markup the output with as much metadata as possible.</li>
<li><code>--positions</code> (<code>-s</code>): output <em>page</em> and <em>offset</em> data for each entry.</li>
<li><code>--pretty</code> (<code>-p</code>): output pretty-printed JSON (useful for debugging).</li>
</ul>
<p>Upon loading and processing the requested EPWING data, Zero-EPWING will output a UTF-8 encoded JSON file to <code>stdout</code>.
Diagnostic information about errors will be printed to <code>stderr</code>. Serious errors will result in this application
returning a non-zero exit code. A sample of the JSON dictionary entry data output is pretty-printed below for reference.</p>
<pre><code class="language-json" style="background-color:#fff">{
    <span style="color:#000080">&#34;charCode&#34;</span>: <span style="color:#d14">&#34;jisx0208&#34;</span>,
    <span style="color:#000080">&#34;discCode&#34;</span>: <span style="color:#d14">&#34;epwing&#34;</span>,
    <span style="color:#000080">&#34;subbooks&#34;</span>: [
        {
            <span style="color:#000080">&#34;title&#34;</span>: <span style="color:#d14">&#34;大辞泉&#34;</span>,
            <span style="color:#000080">&#34;copyright&#34;</span>: <span style="color:#d14">&#34;CD-ROM版大辞泉　1997年4月10日 第1版発行\n\n監　修　松村　明\n発行者　鈴木俊彦\n発行所...&#34;</span>,
            <span style="color:#000080">&#34;entries&#34;</span>: [
                {
                    <span style="color:#000080">&#34;heading&#34;</span>: <span style="color:#d14">&#34;亜&#34;</span>,
                    <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;亜\n［音］ア\n［訓］つ‐ぐ\n［部首］二\n［総画数］７\n［コード］区点...&#34;</span>
                },
                {
                    <span style="color:#000080">&#34;heading&#34;</span>: <span style="color:#d14">&#34;あ&#34;</span>,
                    <span style="color:#000080">&#34;text&#34;</span>: <span style="color:#d14">&#34;あ\n{{w_50275}}\n{{w_50035}}五十音図ア行の第一音。五母音の一。後舌の開母音...&#34;</span>
                }
            ]
        }
    ]
}
</code></pre>
<p>You may have noticed the unusual-looking double curly bracket markers such as <code>{{w_50035}}</code>. Remember what I mentioned
about certain characters being represented by image files? There are two graphical fonts sets in each dictionary: narrow
and wide. Both of these font sets are available in four sizes: 24, 30, 36, and 48 pixels. Whenever a character cannot be
encoded as text, a glyph is used in its place. These font indices cannot be converted directly to characters, differ
from one dictionary to another, and must be manually mapped to Unicode character tables. Zero-EWPING has no facility to
map these font glyphs to Unicode by itself, and instead places inline markers in the form of <code>{{w_xxxx}}</code> and
<code>{{n_xxxx}}</code> in the output, specifying the referenced indices of the wide or narrow fonts respectively.</p>
<p>The bitmaps for these font glyphs can be dumped by executing this application with the <code>--fonts</code> command line argument.</p>

    

<div>
    <nav class="breadcrumb">
        
        <a href="/projects/index.html" class="breadcrumb-item">Projects</a>
        
        
        <span class="breadcrumb-item active">Zero-EPWING</span>
        
    </nav>
</div>


</div>

    <script src="/lib/jquery.min.js"></script>
    <script src="/lib/tether/js/tether.min.js"></script>
    <script src="/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="/lib/lightbox/ekko-lightbox.min.js"></script>
    <script src="/main.js"></script>
    



<!-- begin livejs code -->
<script>
 /*
  Live.js - One script closer to Designing in the Browser
  Written for Handcraft.com by Martin Kool (@mrtnkl).

  Version 4.
  Recent change: Made stylesheet and mimetype checks case insensitive.

  http://livejs.com
  http://livejs.com/license (MIT)  
  @livejs

  Include live.js#css to monitor css changes only.
  Include live.js#js to monitor js changes only.
  Include live.js#html to monitor html changes only.
  Mix and match to monitor a preferred combination such as live.js#html,css  

  By default, just include live.js to monitor all css, js and html changes.
  
  Live.js can also be loaded as a bookmarklet. It is best to only use it for CSS then,
  as a page reload due to a change in html or css would not re-include the bookmarklet.
  To monitor CSS and be notified that it has loaded, include it as: live.js#css,notify
*/
(function () {

  var headers = { "Etag": 1, "Last-Modified": 1, "Content-Length": 1, "Content-Type": 1 },
      resources = {},
      pendingRequests = {},
      currentLinkElements = {},
      oldLinkElements = {},
      interval = 1000,
      loaded = false,
      active = { "html": 1, "css": 1, "js": 1 };

  var Live = {

    // performs a cycle per interval
    heartbeat: function () {      
      if (document.body) {        
        // make sure all resources are loaded on first activation
        if (!loaded) Live.loadresources();
        Live.checkForChanges();
      }
      setTimeout(Live.heartbeat, interval);
    },

    // loads all local css and js resources upon first activation
    loadresources: function () {

      // helper method to assert if a given url is local
      function isLocal(url) {
        var loc = document.location,
            reg = new RegExp("^\\.|^\/(?!\/)|^[\\w]((?!://).)*$|" + loc.protocol + "//" + loc.host);
        return url.match(reg);
      }

      // gather all resources
      var scripts = document.getElementsByTagName("script"),
          links = document.getElementsByTagName("link"),
          uris = [];

      // track local js urls
      for (var i = 0; i < scripts.length; i++) {
        var script = scripts[i], src = script.getAttribute("src");
        if (src && isLocal(src))
          uris.push(src);
        if (src && src.match(/\blive.js#/)) {
          for (var type in active)
            active[type] = src.match("[#,|]" + type) != null
          if (src.match("notify")) 
            alert("Live.js is loaded.");
        }
      }
      if (!active.js) uris = [];
      if (active.html) uris.push(document.location.href);

      // track local css urls
      for (var i = 0; i < links.length && active.css; i++) {
        var link = links[i], rel = link.getAttribute("rel"), href = link.getAttribute("href", 2);
        if (href && rel && rel.match(new RegExp("stylesheet", "i")) && isLocal(href)) {
          uris.push(href);
          currentLinkElements[href] = link;
        }
      }

      // initialize the resources info
      for (var i = 0; i < uris.length; i++) {
        var url = uris[i];
        Live.getHead(url, function (url, info) {
          resources[url] = info;
        });
      }

      // add rule for morphing between old and new css files
      var head = document.getElementsByTagName("head")[0],
          style = document.createElement("style"),
          rule = "transition: all .3s ease-out;"
      css = [".livejs-loading * { ", rule, " -webkit-", rule, "-moz-", rule, "-o-", rule, "}"].join('');
      style.setAttribute("type", "text/css");
      head.appendChild(style);
      style.styleSheet ? style.styleSheet.cssText = css : style.appendChild(document.createTextNode(css));

      // yep
      loaded = true;
    },

    // check all tracking resources for changes
    checkForChanges: function () {
      for (var url in resources) {
        if (pendingRequests[url])
          continue;

        Live.getHead(url, function (url, newInfo) {
          var oldInfo = resources[url],
              hasChanged = false;
          resources[url] = newInfo;
          for (var header in oldInfo) {
            // do verification based on the header type
            var oldValue = oldInfo[header],
                newValue = newInfo[header],
                contentType = newInfo["Content-Type"];
            switch (header.toLowerCase()) {
              case "etag":
                if (!newValue) break;
                // fall through to default
              default:
                hasChanged = oldValue != newValue;
                break;
            }
            // if changed, act
            if (hasChanged) {
              Live.refreshResource(url, contentType);
              break;
            }
          }
        });
      }
    },

    // act upon a changed url of certain content type
    refreshResource: function (url, type) {
      switch (type.toLowerCase()) {
        // css files can be reloaded dynamically by replacing the link element                               
        case "text/css":
          var link = currentLinkElements[url],
              html = document.body.parentNode,
              head = link.parentNode,
              next = link.nextSibling,
              newLink = document.createElement("link");

          html.className = html.className.replace(/\s*livejs\-loading/gi, '') + ' livejs-loading';
          newLink.setAttribute("type", "text/css");
          newLink.setAttribute("rel", "stylesheet");
          newLink.setAttribute("href", url + "?now=" + new Date() * 1);
          next ? head.insertBefore(newLink, next) : head.appendChild(newLink);
          currentLinkElements[url] = newLink;
          oldLinkElements[url] = link;

          // schedule removal of the old link
          Live.removeoldLinkElements();
          break;

        // check if an html resource is our current url, then reload                               
        case "text/html":
          if (url != document.location.href)
            return;

          // local javascript changes cause a reload as well
        case "text/javascript":
        case "application/javascript":
        case "application/x-javascript":
          document.location.reload();
      }
    },

    // removes the old stylesheet rules only once the new one has finished loading
    removeoldLinkElements: function () {
      var pending = 0;
      for (var url in oldLinkElements) {
        // if this sheet has any cssRules, delete the old link
        try {
          var link = currentLinkElements[url],
              oldLink = oldLinkElements[url],
              html = document.body.parentNode,
              sheet = link.sheet || link.styleSheet,
              rules = sheet.rules || sheet.cssRules;
          if (rules.length >= 0) {
            oldLink.parentNode.removeChild(oldLink);
            delete oldLinkElements[url];
            setTimeout(function () {
              html.className = html.className.replace(/\s*livejs\-loading/gi, '');
            }, 100);
          }
        } catch (e) {
          pending++;
        }
        if (pending) setTimeout(Live.removeoldLinkElements, 50);
      }
    },

    // performs a HEAD request and passes the header info to the given callback
    getHead: function (url, callback) {
      pendingRequests[url] = true;
      var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XmlHttp");
      xhr.open("HEAD", url, true);
      xhr.onreadystatechange = function () {
        delete pendingRequests[url];
        if (xhr.readyState == 4 && xhr.status != 304) {
          xhr.getAllResponseHeaders();
          var info = {};
          for (var h in headers) {
            var value = xhr.getResponseHeader(h);
            // adjust the simple Etag variant to match on its significant part
            if (h.toLowerCase() == "etag" && value) value = value.replace(/^W\//, '');
            if (h.toLowerCase() == "content-type" && value) value = value.replace(/^(.*?);.*?$/i, "$1");
            info[h] = value;
          }
          callback(url, info);
        }
      }
      xhr.send();
    }
  };

  // start listening
  if (document.location.protocol != "file:") {
    if (!window.liveJsLoaded)
      Live.heartbeat();

    window.liveJsLoaded = true;
  }
  else if (window.console)
    console.log("Live.js doesn't support the file protocol. It needs http.");    
})();
</script>
<!-- end livejs code -->
</body></html>